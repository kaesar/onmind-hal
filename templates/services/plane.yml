name: Plane
description: Modern project management platform
commands:
  install:
    - docker pull makeplane/plane-frontend:latest
    - docker pull makeplane/plane-backend:latest
    - docker pull makeplane/plane-worker:latest
  setup:
    - docker volume create plane_uploads
  run: |-
    docker run \
          -d \
          --name plane-worker \
          --network {{NETWORK_NAME}} \
          -e DATABASE_URL=postgresql://postgres:{{STORAGE_PASSWORD}}@postgresql:5432/plane \
          -e REDIS_URL=redis://redis:6379/ \
          -e WEB_URL=https://plane.{{DOMAIN}} \
          --restart unless-stopped makeplane/plane-worker:latest && docker run \
          -d \
          --name plane-backend \
          --network {{NETWORK_NAME}} \
          -e DATABASE_URL=postgresql://postgres:{{STORAGE_PASSWORD}}@postgresql:5432/plane \
          -e REDIS_URL=redis://redis:6379/ \
          -e WEB_URL=https://plane.{{DOMAIN}} \
          -e CORS_ALLOWED_ORIGINS=https://plane.{{DOMAIN}} \
          --restart unless-stopped makeplane/plane-backend:latest && docker run \
          -d \
          --name plane-frontend \
          --network {{NETWORK_NAME}} \
          -p 8084:3000 \
          -e NEXT_PUBLIC_API_BASE_URL=https://plane.{{DOMAIN}} \
          --restart unless-stopped \
          makeplane/plane-frontend:latest
variables:
  - NETWORK_NAME
  - STORAGE_PASSWORD
  - DOMAIN
volumes:
  - plane_uploads:/opt/plane/uploads
dependencies:
  - postgresql
  - redis
